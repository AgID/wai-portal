version: '3.7'

volumes:
  application-code:
    driver: local
    external: true
  application-logs:
    driver: local
    external: true
  application-mariadb-data:
    driver: local
    external: true
  application-elastic-data:
    driver: local
    external: true

services:
# php-fpm
  php-fpm:
    volumes:
      - application-code:${APP_CODE_PATH_CONTAINER}

# queue-worker
  queue-worker:
    volumes:
      - application-code:${APP_CODE_PATH_CONTAINER}

# nginx
  nginx:
    volumes:
      - type: volume
        source: application-code
        target: ${APP_CODE_PATH_CONTAINER}
        volume:
          nocopy: true
      - application-logs:${APP_LOGS_PATH_CONTAINER}

# mariadb
  mariadb:
    volumes:
      - application-mariadb-data:/var/lib/mysql

# elasticsearch
  elasticsearch:
    volumes:
      - application-elastic-data:/usr/share/elasticsearch/data
